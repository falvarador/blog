---
interface Props {
  start?: number;
}

const { start = 0 } = Astro.props;
---

<style>
  astro-heart {
    & button {
      color: var(--accent-color-5);
      font-size: 1.5rem;
      line-height: 1;
      position: relative;
    }

    & button:hover {
      color: var(--accent-color-6);
    }

    & button:focus {
      color: var(--accent-color-6);
    }

    & button span {
      color: var(--accent-color-7);
      font-size: 0.5rem;
      line-height: 1;
      position: absolute;
      right: 0;
      top: 0;
    }
  }
</style>

<astro-heart data-start={start}>
  <button aria-label="Heart">ðŸ’œ Ã— <span class="font-6">{start}</span></button>
</astro-heart>

<script>
  class AstroHeart extends HTMLElement {
    count: number;
    button: HTMLButtonElement;
    span: HTMLSpanElement;

    constructor() {
      super();

      this.count = 0;
      this.button = this.querySelector<HTMLButtonElement>("button")!;
      this.span = this.querySelector<HTMLSpanElement>("span")!;

      const start = this.getAttribute("data-start");
      if (start) this.count = parseInt(start) || 0;
    }

    connectedCallback() {
      this.button.addEventListener("click", this);
    }

    disconnectedCallback() {
      this.button.removeEventListener("click", this);
    }

    handleEvent(event: Event) {
      if (event.type === "click") this.handleClick();
    }

    handleClick() {
      this.count++;
      this.span.textContent = this.count.toString();
    }
  }

  customElements.define("astro-heart", AstroHeart);
</script>
